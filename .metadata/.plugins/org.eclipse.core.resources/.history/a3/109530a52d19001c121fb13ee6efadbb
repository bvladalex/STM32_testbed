enum state_codes { start, vol, bal, fan};
enum ret_codes { ok, fail, repeat};

static int start_state(void);
static int vol_state(void);
static int bal_state(void);
static int fan_state(void);

struct transition {
	enum state_codes src_state;
	enum ret_codes   ret_code;
	enum state_codes dst_state;
};

/* transitions from end state aren't needed */
struct transition state_transitions[] = {
	{start, ok,     vol},
	//{start, fail,   end},
	{vol,   ok,     bal},
	//{foo,   fail,   end},
	//{foo,   repeat, foo},
	{bal,   ok,     fan},
	//{bar,   fail,   end},
	{fan,   ok, vol}
	};
	
static enum state_codes lookup_transitions(enum state_codes current, enum ret_codes ret)