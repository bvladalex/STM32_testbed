#ifndef __FSM_H
#define __FSM_H

enum state_codes { start, vol, bal, fan};
enum ret_codes { ok, fail, repeat};

static int start_state(void);
static int vol_state(void);
static int bal_state(void);
static int fan_state(void);

struct transition {
	enum state_codes src_state;
	enum ret_codes   ret_code;
	enum state_codes dst_state;
};

/* transitions from end state aren't needed */
struct transition state_transitions[] = {
	{start, ok,     vol},
	{vol,   ok,     bal},
	{bal,   ok,     fan},
	{fan,   ok, 	vol}};
	
static enum state_codes lookup_transitions(enum state_codes current, enum ret_codes ret);

/* array and enum below must be in sync! */
int (*state[])(void) = { start_state, vol_state, bal_state, fan_state};

#endif
